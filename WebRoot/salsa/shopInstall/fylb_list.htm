<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<title>费用类别</title>
		<meta http-equiv="Content-Type" content="text/html; charset=gbk">
		<link href="css/style1.css" rel="stylesheet" type="text/css">
		<link rel="stylesheet" type="text/css" href="css/easyui/default/easyui.css">
		<link rel="stylesheet" type="text/css" href="css/easyui/icon.css">
		<link type="text/css" rel="stylesheet" 	href="css/ztree/zTreeStyle/zTreeStyle.css">


<link rel="stylesheet" type="text/css" href="css/ext-all.css" />	
<script type="text/javascript" src="js/extjs/ext-base.js"></script>
<script type="text/javascript" src="js/extjs/ext-all.js"></script>
<script type="text/javascript" src="js/extjs/openWindow.js"></script>
		<script type="text/javascript" src="js/easyui/jquery-1.8.0.min.js"></script>
		<script type="text/javascript" src="js/easyui/jquery.easyui.min.js"></script>

		<script type="text/javascript" src="js/easyui/easyui-lang-zh_CN.js"></script>
		<script type="text/javascript" src="js/easyui/json2.js"></script>
		<script type="text/javascript" src="js/easyui/easyui-webase.js"></script>
		<script type='text/javascript' src='dwr/engine.js'></script>
<script type='text/javascript' src='dwr/util.js'></script>
<script type='text/javascript' src='dwr/interface/DwrComm.js'></script>
		<script>
   $(function(){
		    
		    var $dg1=$('#productList');
		    
			$dg1.datagrid({
				title:'',
				width:document.body.clientWidth-15,			
				height:document.body.clientHeight-40,
				nowrap: true,
				autoRowHeight: false,
				striped: true,
				singleSelect:true,
				collapsible:true,
				url:'query?proname=MJP275&Agent_Code='+form1.Agent_Code.value,
				showFooter:true,
				remoteSort: false,
				idField:'bm',
				columns:[[
					{title:'编号',field:'bm',width:45,hidden:true},
        			{title:'费用',field:'mc',width: 185},
        			{title:'店铺名称',field:'agent_name',width:240}
    			]],
				pagination:false,
				rownumbers:true,
				toolbar:[{
					id:'btnupdate',
					text:'新增',
					iconCls:'icon-add',
					handler:function(){
						form1.d_Flag.value = "0";
			     	    openWindow('b-win','费用类别新增','display?proname=shopInstall/fylb_add.htm&agent_code='+form1.Agent_Code.value,400,230,function(){
							 if(form1.d_Flag.value == "1"){
						         $dg1.datagrid('reload');  
					          }
						});
					}},'-',{
					id:'btnupdate',
					text:'修改',
					iconCls:'icon-tip',
					handler:function(){
						 var row = $dg1.datagrid('getSelected'); 
			             if(!row) 
				          {
					          $.messager.alert('提示信息','请选择记录。','info'); 
					          return false;
				          }
					    form1.d_Flag.value = "0";						      				   
					      openWindow('b-win','费用类别修改','display?proname=shopInstall/fylb_update.htm&bm='+row.bm,400,230,function(){
							 if(form1.d_Flag.value == "1"){
						         $dg1.datagrid('reload');  
					          }
						});
					    
					}},'-',{
					id:'btnupdate',
					text:'删除',
					iconCls:'icon-remove',
					handler:function(){
						 var row = $dg1.datagrid('getSelected'); 
			             if(!row) 
				          {
					          $.messager.alert('提示信息','请选择记录。','info'); 
					          return false;
				          }
					     form1.BM.value = row.bm ;	
					   if (typeof window['DWRUtil'] == 'undefined') window.DWRUtil = dwr.util;
	    			   var formMap = DWRUtil.getValues("form1");
		  				 if (!confirm("删除的数据无法修复，你确定删除吗？")) {  return false;      }  
					   DwrComm.parseIN('INP083',formMap,"delete",{callback:function(data){
					        if (data != 'ok'){
					               alert(data);
					        }else{
					        	  alert("操作成功");
					              $dg1.datagrid('reload');  
					        }
					   },async:false});	
					}
				}]
			});
			
			$("#Agent_Code").change(function(){
     	$dg1.datagrid({
				title:'',
				width:document.body.clientWidth-15,			
				height:document.body.clientHeight-40,
				nowrap: true,
				autoRowHeight: false,
				striped: true,
				singleSelect:true,
				collapsible:true,
				url:'query?proname=MJP275&Agent_Code='+form1.Agent_Code.value,
				showFooter:true,
				remoteSort: false,
				idField:'bm',
				columns:[[
					{title:'编号',field:'bm',width:45,hidden:true},
        			{title:'费用',field:'mc',width: 185},
        			{title:'店铺名称',field:'agent_name',width:240}
    			]],
				pagination:false,
				rownumbers:true,
				toolbar:[{
					id:'btnupdate',
					text:'新增',
					iconCls:'icon-add',
					handler:function(){
						form1.d_Flag.value = "0";
			     	    openWindow('b-win','费用类别新增','display?proname=shopInstall/fylb_add.htm&agent_code='+form1.Agent_Code.value,400,230,function(){
							 if(form1.d_Flag.value == "1"){
						         $dg1.datagrid('reload');  
					          }
						});
					}},'-',{
					id:'btnupdate',
					text:'修改',
					iconCls:'icon-tip',
					handler:function(){
						 var row = $dg1.datagrid('getSelected'); 
			             if(!row) 
				          {
					          $.messager.alert('提示信息','请选择记录。','info'); 
					          return false;
				          }
					    form1.d_Flag.value = "0";						      				   
					      openWindow('b-win','费用类别修改','display?proname=shopInstall/fylb_update.htm&bm='+row.bm,400,230,function(){
							 if(form1.d_Flag.value == "1"){
						         $dg1.datagrid('reload');  
					          }
						});
					    
					}},'-',{
					id:'btnupdate',
					text:'删除',
					iconCls:'icon-remove',
					handler:function(){
						 var row = $dg1.datagrid('getSelected'); 
			             if(!row) 
				          {
					          $.messager.alert('提示信息','请选择记录。','info'); 
					          return false;
				          }
					     form1.BM.value = row.bm ;	
					   if (typeof window['DWRUtil'] == 'undefined') window.DWRUtil = dwr.util;
	    			   var formMap = DWRUtil.getValues("form1");
		  				 if (!confirm("删除的数据无法修复，你确定删除吗？")) {  return false;      }  
					   DwrComm.parseIN('INP083',formMap,"delete",{callback:function(data){
					        if (data != 'ok'){
					               alert(data);
					        }else{
					        	  alert("操作成功");
					              $dg1.datagrid('reload');  
					        }
					   },async:false});	
					}
				}]
			});
    });
		
   
   
     
	});
	 
</script>


	</head>

	<body>
		<form name="form1" id="form1" method="post">
			<input type="hidden" name="BM">
			<input type="hidden" name="MC">
			<input type="hidden" name="win_Flag" value="">
			<input type="hidden" name="d_Flag" value="0">
			<table width="100%" height="0" border="0" align="center" cellpadding="0" cellspacing="0">
				<tr align="center" height="5">
					<td>&nbsp;		</td>
				</tr>
				<tr align="center">
					<td>
						<table cellSpacing=0 cellPadding=0 border="0" width="100%">
							<tr height="30">
								<td style="BORDER-BOTTOM: @@LS.BGCOLOR, 1px solid; font-size: 12pt; COLOR: #124164; FONT-WEIGHT: bold;">
									<img src="images/webtype/colon.gif" WIDTH="24" HEIGHT="24">
									费用类别   
								</td>
								<td style="BORDER-BOTTOM: @@LS.BGCOLOR, 1px solid; font-size: 12pt; COLOR: #124164; FONT-WEIGHT: bold;">
									   门店：<select  name="Agent_Code" id="Agent_Code" >
								 
                                  <option>$$XL0008,</option>
                              </select>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				
				<tr>
					<td style="background-color:#FFFFFF;">
						<div id="productList"></div>
					</td>
				</tr>
				<tr></tr>
			</table>
		</form>
	</body>
</html>
